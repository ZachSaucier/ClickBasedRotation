function dRotate(t,r){var e=r.dataset,s=e.rotType||"realistic",a=e.rotAmount||15,o=r.clientWidth,n=r.clientHeight,i=parseInt(0===document.body.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),d=parseInt(0===document.body.scrollTop?document.documentElement.scrollTop:document.body.scrollTop),l=t.clientX-r.offsetLeft+i,m=t.clientY-r.offsetTop+d,f=o/2,c=n/2;if("realistic"==s){var p=f-l,y=c-m,u=f+c,g=Math.abs(p)+Math.abs(y),T="translateZ("+-(u-g)/8+"px) rotateY("+-p/8*a/15+"deg) rotateX("+y/4*a/15+"deg)";trans(r,T)}else if("simple"==s){var O=Math.max(o,n),b=e.rotOrigin||"center center";f+o/8>=l&&l>=f-o/8&&c+n/8>=m&&m>=c-n/8?rotate(r,"c"):n/2>=m?o/2>=l?l>=m?(rotate(r,"t"),"opposite"==b&&transO(r,"bottom center")):(rotate(r,"l"),"opposite"==b&&transO(r,"right center")):O>=l+m?(rotate(r,"t"),"opposite"==b&&transO(r,"bottom center")):(rotate(r,"r"),"opposite"==b&&transO(r,"left center")):o/2>=l?O>=l+m?(rotate(r,"l"),"opposite"==b&&transO(r,"right center")):(rotate(r,"b"),"opposite"==b&&transO(r,"top center")):l-o/2>=m-n/2?(rotate(r,"r"),"opposite"==b&&transO(r,"left center")):(rotate(r,"b"),"opposite"==b&&transO(r,"top center"))}}function rotate(t,r){var e=t.dataset.rotAmount||15;"c"==r?trans(t,"translateZ(-"+e+"px)"):"t"==r?trans(t,"rotateX("+e+"deg)"):"r"==r?trans(t,"rotateY("+e+"deg)"):"b"==r?trans(t,"rotateX(-"+e+"deg)"):"l"==r&&trans(t,"rotateY(-"+e+"deg)")}function trans(t,r){""==t.style.MozTransform&&""==t.style.transform||""==t.style.msTransform&&""==t.style.transform||""==t.style.OTransform&&""==t.style.transform?(t.parentNode.style.perspective=(t.getAttribute("data-rot-perspective")||400)+"px",t.style.MozTransform=r,t.style.msTransform=r,t.style.OTransform=r,t.style.transform=r):(t.style.MozTransform=r,t.style.msTransform=r,t.style.OTransform=r,t.style.transform=r),r="perspective("+(t.getAttribute("data-rot-perspective")||400)+") "+r,t.style.webkitTransform=r,t.style.MozTransform=r,t.style.msTransform=r,t.style.OTransform=r,t.style.transform=r}function transO(t,r){t.style.webkitTransformOrigin=r,t.style.MozTransformOrigin=r,t.style.msTransformOrigin=r,t.style.OTransformOrigin=r,t.style.transformOrigin=r}for(var drs=document.getElementsByClassName("rot-dir"),isAnimating=!1,animElem,i=0;i<drs.length;i++){var dataSet=drs[i].dataset,duration=dataSet.rotDur||.1,ease=dataSet.rotEase||"ease-out",transOrigin=dataSet.rotOrigin||"center center";drs[i].dataset.rotInit=drs[i].dataset.rotInit||"rotate(0deg)",trans(drs[i],drs[i].dataset.rotInit),drs[i].dataset.rotStart=drs[i].dataset.rotStart||"",drs[i].dataset.rotEnd=drs[i].dataset.rotEnd||"",drs[i].style.webkitTransition="-webkit-transform "+duration+"s "+ease,drs[i].style.MozTransition="-moz-transform "+duration+"s "+ease,drs[i].style.msTransition="-ms-transform "+duration+"s "+ease,drs[i].style.OTransition="-o-transform "+duration+"s "+ease,drs[i].style.transition="transform "+duration+"s "+ease,drs[i].style.outline="1px solid transparent",transO(drs[i],transOrigin),drs[i].onmousedown=function(e){isAnimating||(isAnimating=!0,""!==this.dataset.rotStart&&eval(this.dataset.rotStart+"()"),dRotate(e,this),animElem=this)}}document.body.onmouseup=function(){trans(animElem,animElem.dataset.rotInit),isAnimating=!1,""!==this.dataset.rotEnd&&eval(this.dataset.rotEnd+"()")};